(()=>{var t={348:t=>{var e;self,e=()=>(()=>{var t={501:function(t,e,n){var o;t=n.nmd(t),function(){var r=(t&&t.exports,"object"==typeof n.g&&n.g);r.global!==r&&r.window;var i=function(t){this.message=t};(i.prototype=new Error).name="InvalidCharacterError";var a=function(t){throw new i(t)},s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=/[\t\n\f\r ]/g,c={encode:function(t){t=String(t),/[^\0-\xFF]/.test(t)&&a("The string to be encoded contains characters outside of the Latin1 range.");for(var e,n,o,r,i=t.length%3,u="",c=-1,l=t.length-i;++c<l;)e=t.charCodeAt(c)<<16,n=t.charCodeAt(++c)<<8,o=t.charCodeAt(++c),u+=s.charAt((r=e+n+o)>>18&63)+s.charAt(r>>12&63)+s.charAt(r>>6&63)+s.charAt(63&r);return 2==i?(e=t.charCodeAt(c)<<8,n=t.charCodeAt(++c),u+=s.charAt((r=e+n)>>10)+s.charAt(r>>4&63)+s.charAt(r<<2&63)+"="):1==i&&(r=t.charCodeAt(c),u+=s.charAt(r>>2)+s.charAt(r<<4&63)+"=="),u},decode:function(t){var e=(t=String(t).replace(u,"")).length;e%4==0&&(e=(t=t.replace(/==?$/,"")).length),(e%4==1||/[^+a-zA-Z0-9/]/.test(t))&&a("Invalid character: the string to be decoded is not correctly encoded.");for(var n,o,r=0,i="",c=-1;++c<e;)o=s.indexOf(t.charAt(c)),n=r%4?64*n+o:o,r++%4&&(i+=String.fromCharCode(255&n>>(-2*r&6)));return i},version:"0.1.0"};void 0===(o=function(){return c}.call(e,n,e,t))||(t.exports=o)}()},97:(t,e,n)=>{"use strict";n(91).polyfill()},91:t=>{"use strict";function e(t,e){if(null==t)throw new TypeError("Cannot convert first argument to object");for(var n=Object(t),o=1;o<arguments.length;o++){var r=arguments[o];if(null!=r)for(var i=Object.keys(Object(r)),a=0,s=i.length;a<s;a++){var u=i[a],c=Object.getOwnPropertyDescriptor(r,u);void 0!==c&&c.enumerable&&(n[u]=r[u])}}return n}t.exports={assign:e,polyfill:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:e})}}},808:(t,e,n)=>{var o,r,i;void 0===(r="function"==typeof(o=i=function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var o in n)e[o]=n[o]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(o){function r(){}function i(e,n,i){if("undefined"!=typeof document){"number"==typeof(i=t({path:"/"},r.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(t){}n=o.write?o.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var u in i)i[u]&&(s+="; "+u,!0!==i[u]&&(s+="="+i[u].split(";")[0]));return document.cookie=e+"="+n+s}}function a(t,n){if("undefined"!=typeof document){for(var r={},i=document.cookie?document.cookie.split("; "):[],a=0;a<i.length;a++){var s=i[a].split("="),u=s.slice(1).join("=");n||'"'!==u.charAt(0)||(u=u.slice(1,-1));try{var c=e(s[0]);if(u=(o.read||o)(u,c)||e(u),n)try{u=JSON.parse(u)}catch(t){}if(r[c]=u,t===c)break}catch(t){}}return t?r[t]:r}}return r.set=i,r.get=function(t){return a(t,!1)},r.getJSON=function(t){return a(t,!0)},r.remove=function(e,n){i(e,"",t(n,{expires:-1}))},r.defaults={},r.withConverter=n,r}((function(){}))})?o.call(e,n,e,t):o)||(t.exports=r),t.exports=i()},671:function(t,e){var n,o;void 0===(o="function"==typeof(n=function(){var t=function(){},e={},n={},o={};function r(t,e){if(t){var r=o[t];if(n[t]=e,r)for(;r.length;)r[0](t,e),r.splice(0,1)}}function i(e,n){e.call&&(e={success:e}),n.length?(e.error||t)(n):(e.success||t)(e)}function a(e,n,o,r){var i,s,u=document,c=o.async,l=(o.numRetries||0)+1,f=o.before||t,d=e.replace(/^(css|img)!/,"");r=r||0,/(^css!|\.css$)/.test(e)?((s=u.createElement("link")).rel="stylesheet",s.href=d,(i="hideFocus"in s)&&s.relList&&(i=0,s.rel="preload",s.as="style")):/(^img!|\.(png|gif|jpg|svg)$)/.test(e)?(s=u.createElement("img")).src=d:((s=u.createElement("script")).src=e,s.async=void 0===c||c),s.onload=s.onerror=s.onbeforeload=function(t){var u=t.type[0];if(i)try{s.sheet.cssText.length||(u="e")}catch(t){18!=t.code&&(u="e")}if("e"==u){if((r+=1)<l)return a(e,n,o,r)}else if("preload"==s.rel&&"style"==s.as)return s.rel="stylesheet";n(e,u,t.defaultPrevented)},!1!==f(e,s)&&u.head.appendChild(s)}function s(t,n,o){var s,u;if(n&&n.trim&&(s=n),u=(s?o:n)||{},s){if(s in e)throw"LoadJS";e[s]=!0}function c(e,n){!function(t,e,n){var o,r,i=(t=t.push?t:[t]).length,s=i,u=[];for(o=function(t,n,o){if("e"==n&&u.push(t),"b"==n){if(!o)return;u.push(t)}--i||e(u)},r=0;r<s;r++)a(t[r],o,n)}(t,(function(t){i(u,t),e&&i({success:e,error:n},t),r(s,t)}),u)}if(u.returnPromise)return new Promise(c);c()}return s.ready=function(t,e){return function(t,e){t=t.push?t:[t];var r,i,a,s=[],u=t.length,c=u;for(r=function(t,n){n.length&&s.push(t),--c||e(s)};u--;)i=t[u],(a=n[i])?r(i,a):(o[i]=o[i]||[]).push(r)}(t,(function(t){i(e,t)})),s},s.done=function(t){r(t,[])},s.reset=function(){e={},n={},o={}},s.isDefined=function(t){return t in e},s})?n.apply(e,[]):n)||(t.exports=o)},237:()=>{function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){var n=this.event&&this.event.type,o="unload"===n||"beforeunload"===n,r="XMLHttpRequest"in this?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");r.open("POST",t,!o),r.withCredentials=!0,r.setRequestHeader("Accept","*/*"),"string"==typeof e?(r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),r.responseType="text/plain"):function(t){return t instanceof Blob}(e)&&e.type&&r.setRequestHeader("Content-Type",e.type);try{r.send(e)}catch(t){return!1}return!0}function n(){return"navigator"in this&&"sendBeacon"in this.navigator}(function(){n.call(this)||("navigator"in this||(this.navigator={}),this.navigator.sendBeacon=e.bind(this))}).call("object"===("undefined"==typeof window?"undefined":t(window))?window:{})},458:(t,e)=>{!function(t){var e,n,o,r=String.fromCharCode;function i(t){for(var e,n,o=[],r=0,i=t.length;r<i;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<i?56320==(64512&(n=t.charCodeAt(r++)))?o.push(((1023&e)<<10)+(1023&n)+65536):(o.push(e),r--):o.push(e);return o}function a(t){if(t>=55296&&t<=57343)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value")}function s(t,e){return r(t>>e&63|128)}function u(t){if(!(4294967168&t))return r(t);var e="";return 4294965248&t?4294901760&t?!(4292870144&t)&&(e=r(t>>18&7|240),e+=s(t,12),e+=s(t,6)):(a(t),e=r(t>>12&15|224),e+=s(t,6)):e=r(t>>6&31|192),e+r(63&t|128)}function c(){if(o>=n)throw Error("Invalid byte index");var t=255&e[o];if(o++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function l(){var t,r;if(o>n)throw Error("Invalid byte index");if(o==n)return!1;if(t=255&e[o],o++,!(128&t))return t;if(192==(224&t)){if((r=(31&t)<<6|c())>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&t)){if((r=(15&t)<<12|c()<<6|c())>=2048)return a(r),r;throw Error("Invalid continuation byte")}if(240==(248&t)&&(r=(7&t)<<18|c()<<12|c()<<6|c())>=65536&&r<=1114111)return r;throw Error("Invalid UTF-8 detected")}t.version="3.0.0",t.encode=function(t){for(var e=i(t),n=e.length,o=-1,r="";++o<n;)r+=u(e[o]);return r},t.decode=function(t){e=i(t),n=e.length,o=0;for(var a,s=[];!1!==(a=l());)s.push(a);return function(t){for(var e,n=t.length,o=-1,i="";++o<n;)(e=t[o])>65535&&(i+=r((e-=65536)>>>10&1023|55296),e=56320|1023&e),i+=r(e);return i}(s)}}(e)},327:t=>{for(var e=[],n=0;n<256;++n)e[n]=(n+256).toString(16).substr(1);t.exports=function(t,n){var o=n||0,r=e;return[r[t[o++]],r[t[o++]],r[t[o++]],r[t[o++]],"-",r[t[o++]],r[t[o++]],"-",r[t[o++]],r[t[o++]],"-",r[t[o++]],r[t[o++]],"-",r[t[o++]],r[t[o++]],r[t[o++]],r[t[o++]],r[t[o++]],r[t[o++]]].join("")}},217:t=>{var e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(e){var n=new Uint8Array(16);t.exports=function(){return e(n),n}}else{var o=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)!(3&e)&&(t=4294967296*Math.random()),o[e]=t>>>((3&e)<<3)&255;return o}}},171:(t,e,n)=>{var o=n(217),r=n(327);t.exports=function(t,e,n){var i=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var a=(t=t||{}).random||(t.rng||o)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,e)for(var s=0;s<16;++s)e[i+s]=a[s];return e||r(a)}}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var i=e[o]={id:o,loaded:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var o={};return(()=>{"use strict";n.r(o),n.d(o,{HorizonClient:()=>ft,IDManager:()=>dt,Settings:()=>s}),n(97);var t=n(171),e=n.n(t);const r=function(t,e){var n=(window.horizonResources=window.horizonResources||{},window.horizonResources);return n[t]=n[t]||e,n[t]};var i={AVOID_COOKIE_USAGE:!1,EVENTS_BUFFER_SIZE:100,EVENTS_SENDER_INTERVAL:1e4,EVENTS_SENDER_MIN_INTERVAL:5e3,EVENTS_SENDER_MAX_INTERVAL:2e4,EVENTS_DISCARD_AFTER_MSECS:36e5,EVENTS_BULK_SIZE:10,HORIZON_CALLBACK_STACK_LIMIT:1e3,HORIZON_TRACK_IDENTIFICATION_RESOURCE:"id",HORIZON_TRACK_HOST:"horizon-track.globo.com",HORIZON_CLIENT_UUID:r("clientInstanceUUID",e()()),HORIZON_REQUEST_ENCODING:"base64",HORIZON_SCHEMAS_HOST:"horizon-schemas.globo.com",IDENTIFICATION_LOAD_RETRY_AFTER_MSECS:5e3,PACKAGE_VERSION:"1.12.0",SCHEMA_VALIDATOR_SCRIPT_URL:"s3.glbimg.com/cdn/libs/tv4/1.3.0/tv4.min.js",SCHEMA_VALIDATOR_SCRIPT_MAX_RETRIES:2,SCHEMA_LOAD_COLLECTION_RETRY_AFTER_MSECS:1e4,USE_HTTPS:!0},a={avoidCookieUsage:function(){i.AVOID_COOKIE_USAGE=!0},useHTTPOnly:function(){i.USE_HTTPS=!1},useQAConfiguration:function(){i.HORIZON_TRACK_HOST="horizon-track.qa.globoi.com",i.HORIZON_SCHEMAS_HOST="horizon-schemas.qa.globoi.com",i.HORIZON_REQUEST_ENCODING="json"},useJSONEncoding:function(){i.HORIZON_REQUEST_ENCODING="json"}};const s=Object.assign(i,a);var u=n(671),c=n.n(u),l={COMPONENT_NOT_READY:"[Horizon] Component is not ready.",COMPONENT_UNAVAILABLE:"[Horizon] Class or function is required.",DUPLICATED_SCHEMA:"[Horizon] Duplicated schema.",ERROR_LOADING_RESOURCE:"[Horizon] Failed to load resource.",INVALID_AUTH_TOKEN:"[Horizon] Invalid authorization token.",INVALID_DATA:"[Horizon] Invalid data.",INVALID_DATE:"[Horizon] Invalid date-time RFC 3339 format.",INVALID_STRING_NUMERIC_STRING:"[Horizon] numericString should be string.",INVALID_EMPTY_NUMERIC_STRING:"[Horizon] numericString should be empty.",INVALID_NUMERIC_STRING:"[Horizon] Invalid number. Field with NumericString must to be number.",INVALID_ENVIRONMENT:"[Horizon] Invalid environment value.",INVALID_FORMAT:"[Horizon] Invalid event format.",INVALID_REQUEST:"[Horizon] Invalid request.",INVALID_TIMESTAMP:"[Horizon] Invalid timestamp.",INVALID_VERSION_FORMAT:"[Horizon] Invalid version format.",INVALID_RELATION_ID:"[Horizon] Invalid relation identification.",LIMIT_EXCEEDED:"[Horizon] Resource limit exceeded.",MUST_BE_DEFINED:"[Horizon] Parameter or argument must be defined",SCHEMA_VALIDATOR_ERROR_LOADING:"[Horizon] Could not load SchemaValidator.",UNSUPPORTED_TYPE:"[Horizon] Unsupported type.",UNSUPPORTED_TENANT:"[Horizon] Unsupported tenant.",UNSUPPORTED_ENCODER:"[Horizon] Unsupported encoder.",USE_MANAGER_ONLY_WHEN_AVOIDING_COOKIE:"[Horizon] Can not set or remove a logged user when AVOID_COOKIE_USAGE is not enabled."},f={mustBeDefined:function(t){throw new Error("".concat(l.MUST_BE_DEFINED,": ").concat(t,"."))}};const d=Object.assign(l,f);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}var p={ready:[]},v=["url"],g=function(){return!!window.tv4},m=function(t){return null===t||isNaN(t)&&!isNaN(Date.parse(t))?null:d.INVALID_DATE},E=function(t){return"string"!=typeof t?d.INVALID_STRING_NUMERIC_STRING:""===t.trim()?d.INVALID_EMPTY_NUMERIC_STRING:Number.isFinite(Number(t))?null:d.INVALID_NUMERIC_STRING};const b={validateFor:function(t,e){if(!g())throw new Error("".concat(d.ERROR_LOADING_RESOURCE," Validator is not ready."));if(!e)throw new Error("".concat(d.INVALID_DATA," Argument: schema."));if(!/\d+\.\d+/.test(t.version))throw new Error(d.INVALID_VERSION_FORMAT);if(!tv4.validate(t.properties,e))throw new Error("".concat(d.INVALID_DATA," ").concat(t.id," ").concat(t.version,". ").concat(tv4.error))},validateArgs:function(t){var e=Object.prototype.hasOwnProperty;if(!(t&&e.call(t,"id")&&e.call(t,"version")&&e.call(t,"properties")))throw new Error("".concat(d.INVALID_FORMAT," Missing properties: ").concat(JSON.stringify(t)));if("string"!=typeof t.id||"string"!=typeof t.version||"object"!==y(t.properties))throw new Error("".concat(d.INVALID_FORMAT," Wrong object type: ").concat(JSON.stringify(t)));if(v.filter((function(e){return t[e]&&"string"!=typeof t[e]})).length>0)throw new Error("".concat(d.INVALID_FORMAT," Wrong object type: ").concat(JSON.stringify(t)));if(t.id.length<2||t.version.length<3)throw new Error("".concat(d.INVALID_FORMAT," Invalid property size: ").concat(JSON.stringify(t)));var n=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){var o,r,i;o=t,r=e,i=n[e],(r=function(t){var e=function(t){if("object"!==y(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!==y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===y(e)?e:String(e)}(r))in o?Object.defineProperty(o,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[r]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t);delete n.id,delete n.version,delete n.properties,delete n.contentType;var o=Object.keys(n);if(o.length>0&&!o.every((function(t){return-1!==v.indexOf(t)})))throw new Error("".concat(d.INVALID_FORMAT," Extra keys aren't allowed: ").concat(JSON.stringify(n)))},tv4IsValidData:m,tv4IsNumericString:E,isReady:g,onReady:function(t){if(g())return t();if(p.ready.length>s.HORIZON_CALLBACK_STACK_LIMIT)throw new Error("".concat(d.LIMIT_EXCEEDED," Validator callback stack."));return p.ready.unshift(t)},load:function(){if(!c().isDefined("tv4")){var t=s.USE_HTTPS?"https://":"http://",e="".concat(t).concat(s.SCHEMA_VALIDATOR_SCRIPT_URL);c()([e],"tv4",{async:!0,numRetries:s.SCHEMA_VALIDATOR_SCRIPT_MAX_RETRIES,success:function(){tv4.addFormat("date-time",m),tv4.addFormat("numericString",E),p.ready.forEach((function(t){return t()}))},error:function(t){throw new Error("".concat(d.SCHEMA_VALIDATOR_ERROR_LOADING," ").concat(t))}})}}};n(237);var I=n(501),S=n.n(I),_=n(458),w=n.n(_),O={base64:function(t){var e=new FormData;return e.append("data",S().encode(w().encode(JSON.stringify(t)))),e.append("encoding","base64"),e},json:function(t){return JSON.stringify(t)}},T=n(808),A=n.n(T);const R=function(t){var e=s.EVENTS_SENDER_MIN_INTERVAL,n=s.EVENTS_SENDER_MAX_INTERVAL,o=Number(A().get("_hzt.interval"))||s.EVENTS_SENDER_INTERVAL;o<=n&&o>=e&&t.interval!==o&&t.reschedule(o)};function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function N(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function D(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(r=function(t){if("object"!==C(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!==C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===C(r)?r:String(r)),o)}var r}var k=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._queue=[],this.maxSize=e}var e,n,o;return e=t,o=[{key:"fromArray",value:function(e,n){var o=new t(n);return e.forEach((function(t){return o.push(t)})),o}}],(n=[{key:"length",get:function(){return this._queue.length}},{key:"items",get:function(){return JSON.parse(JSON.stringify(this._queue))}},{key:"push",value:function(t){var e;this._queue=[t].concat(function(t){if(Array.isArray(t))return N(t)}(e=this.slice(0,this.maxSize-1))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return N(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}},{key:"forEach",value:function(t){return this._queue.forEach(t)}},{key:"slice",value:function(t,e){return this._queue.slice(t,e)}},{key:"splice",value:function(t,e){return this._queue.splice(t,e)}},{key:"clear",value:function(){this._queue=[]}},{key:"filter",value:function(e){return t.fromArray(this._queue.filter(e),this.maxSize)}}])&&D(e.prototype,n),o&&D(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();const L=k;function H(t){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H(t)}const U=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.interval=0,this.tickIntervalId=0,this.callbacks=[]}var e,n;return e=t,(n=[{key:"isRunning",get:function(){return!!this.tickIntervalId}},{key:"tick",value:function(){var t=this;this.callbacks.forEach((function(e){return e(t)}))}},{key:"start",value:function(){return this.tickIntervalId=setInterval(this.tick.bind(this),this.interval),this}},{key:"stop",value:function(){return clearInterval(this.tickIntervalId),this.tickIntervalId=0,this}},{key:"reschedule",value:function(t){return this.stop().every(t).start()}},{key:"every",value:function(t){return this.interval=t,this}},{key:"call",value:function(t){return this.callbacks.push(t),this}}])&&function(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(r=function(t){if("object"!==H(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!==H(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===H(r)?r:String(r)),o)}var r}(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}var V=function(){function t(e,n,o,r,i){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.currentTenant=e||d.mustBeDefined("tenant"),this.instanceID=n||d.mustBeDefined("instanceID"),this.deviceGroup=o||d.mustBeDefined("deviceGroup"),this.environment=r||d.mustBeDefined("environment"),this.queue=new L(s.EVENTS_BUFFER_SIZE),this.idManager=i,this.dispatchNumber=1,this.actionCounter=0,(new U).every(s.EVENTS_SENDER_INTERVAL).call((function(){a.queue=a.filterQueue();var t=a.prepareRequest();a.dispatch(t,s.HORIZON_REQUEST_ENCODING)||t.actions.forEach((function(t){return a.enqueue(t)}))})).call(R).start()}var e,n;return e=t,n=[{key:"length",get:function(){return this.queue.length}},{key:"setMaxQueueSize",value:function(t){this.queue=L.fromArray(this.queue.items,t)}},{key:"filterQueue",value:function(){var t=+Date.now()-s.EVENTS_DISCARD_AFTER_MSECS;return this.queue.filter((function(e){return e.actionTs>t}))}},{key:"prepareRequest",value:function(){var t=this.queue.splice(0,s.EVENTS_BULK_SIZE);return this.actionCounter+=t.length,{horizonClientUUID:this.instanceID,horizonClientTenant:this.currentTenant,horizonClientTs:Date.now(),horizonClientType:"js",horizonClientDeviceGroup:this.deviceGroup,horizonDispatchNumber:this.dispatchNumber,horizonActionCounter:this.actionCounter,horizonEnvironment:this.environment,actions:t}}},{key:"isValidRequest",value:function(t){if(!t||t&&!t.actions)throw new Error(d.INVALID_REQUEST);return t.actions.length>0}},{key:"sendByFetch",value:function(t,e){try{return fetch(t,{method:"POST",credentials:"include",body:e}).then((function(t){t.ok||console.error("Failed to send Horizon events using fetch. Status ".concat(t.status," - ").concat(t.statusText))})),!0}catch(t){return!1}}},{key:"sendByXMLHttpRequest",value:function(t,e,n){try{var o=new XMLHttpRequest;return o.open("POST",t),o.withCredentials=!0,"json"===n&&o.setRequestHeader("Content-Type","application/json"),o.onreadystatechange=function(){if(o.readyState===XMLHttpRequest.DONE){var t=o.status,e=o.statusText;0===t||t>=200&&t<400||console.error("Failed to send Horizon events using XMLHttpRequest. Status ".concat(t," - ").concat(e))}},o.send(e),!0}catch(t){return!1}}},{key:"dispatch",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"json",n=s.USE_HTTPS?"https://":"http://",o=this.idManager.getAsKeyValue(),r=o?"?".concat(o):"",i="".concat(n).concat(A().get("_hzt.host")||s.HORIZON_TRACK_HOST,"/event/").concat(this.currentTenant).concat(r),a=function(t){if(!(t in O))throw new Error("".concat(d.UNSUPPORTED_ENCODER," Invalid ").concat(t," encoder."));return O[t]}(e);if(!this.isValidRequest(t))return!1;this.dispatchNumber+=1;var u=a(t),c=!1,l=!1,f=!1;try{c=navigator.sendBeacon(i,u)}catch(t){c=!1}return c||(f=this.sendByFetch(i,u))||(l=this.sendByXMLHttpRequest(i,u,e)),c||f||l}},{key:"enqueue",value:function(t){if(!t.actionTs)throw new Error(d.INVALID_TIMESTAMP);this.queue.push(t)}},{key:"flush",value:function(){for(;this.queue.length>0;){this.queue=this.filterQueue();var t=this.prepareRequest();this.dispatch(t,s.HORIZON_REQUEST_ENCODING)}}}],n&&function(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(r=function(t){if("object"!==P(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!==P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===P(r)?r:String(r)),o)}var r}(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();const j=function(t,e){setTimeout((function(){return t(e)}),1)},M=function(t,e,n,o){var r=new XMLHttpRequest;r.open(t,e,!0),r.onload=function(){return r.status<400?n(JSON.parse(r.response)):o(r.response)},r.onerror=o,r.send()};function x(t){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(t)}var z="statusReady",q="statusNotReady",G="statusError",F=function(){return r("schemas",{data:{}})},B=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.url=e,this.state=q,this.callbacks={onReady:[],onError:[],onRetry:[],onLoad:[]}}var e,n;return e=t,(n=[{key:"get",value:function(t,e){var n="".concat(t,"-").concat(e);if(!this.isReady())throw new Error("".concat(d.COMPONENT_NOT_READY));var o=F().data[n];if(!o)throw new Error("".concat(d.UNSUPPORTED_TYPE,": ").concat(n));return o}},{key:"isReady",value:function(){return this.state===z}},{key:"retry",value:function(){var t=this;this.state="statusScheduled",this.callbacks.onRetry.forEach((function(t){return t()})),setTimeout((function(){t.state=q,t.load()}),s.SCHEMA_LOAD_COLLECTION_RETRY_AFTER_MSECS)}},{key:"onLoad",value:function(t){this.callbacks.onLoad.push(t)}},{key:"onRetry",value:function(t){this.callbacks.onRetry.push(t)}},{key:"onReady",value:function(t){if(this.state===z)return t(F().data);if(this.callbacks.onReady.length>s.HORIZON_CALLBACK_STACK_LIMIT)throw new Error("".concat(d.LIMIT_EXCEEDED," Schemas callback stack."));return this.callbacks.onReady.push(t)}},{key:"onError",value:function(t){this.state===G?t():this.callbacks.onError.push(t)}},{key:"load",value:function(){var t=this,e=F();if(this.state===q){this.state="statusLoading",this.callbacks.onLoad.forEach((function(t){return t()}));var n=s.USE_HTTPS?"https://":"http://";M("GET","".concat(n).concat(this.url),(function(n){e.data=Object.assign(e.data||{},n),t.state=z,t.callbacks.onReady.forEach((function(t){return j(t,e.data)}))}),(function(e){t.state=G,t.callbacks.onError.forEach((function(t){return j(t,e)})),t.retry()}))}}}])&&function(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(r=function(t){if("object"!==x(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!==x(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===x(r)?r:String(r)),o)}var r}(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),K=function(t){return window.cdaaas&&window.cdaaas.SETTINGS?window.cdaaas.SETTINGS[t]:null},Z=function(t){return window.utag_data?window.utag_data[t]:null};function W(t){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W(t)}function X(t){var e=function(t){if("object"!==W(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!==W(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===W(e)?e:String(e)}var J=function(){return r("idManager",{loggedIDs:null,anonymousIDs:null,sessionIDs:null})},Q=["GLBID","GST","EXT_ID","globoId"],Y="statusReady",$="statusNotReady",tt="statusError",et=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.state=n?Y:$,this.url=e,this.bypass=n,this.callbacks={onReady:[],onError:[],onRetry:[],onLoad:[]}}var e,n;return e=t,n=[{key:"onLoad",value:function(t){this.callbacks.onLoad.push(t)}},{key:"onRetry",value:function(t){this.callbacks.onRetry.push(t)}},{key:"onReady",value:function(t){if(this.state===Y)return t(this.getClientIDs());if(this.callbacks.onReady.length>s.HORIZON_CALLBACK_STACK_LIMIT)throw new Error("".concat(d.LIMIT_EXCEEDED," IDManager callback stack."));return this.callbacks.onReady.push(t)}},{key:"onError",value:function(t){this.state===tt?t():this.callbacks.onError.push(t)}},{key:"getAsKeyValue",value:function(){if(!this.isReady())throw new Error("".concat(d.COMPONENT_NOT_READY));if(this.bypass)return"";var t=this.getClientIDs();return Object.keys(t).map((function(e){return"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t[e]))})).join("&")}},{key:"getClientIDs",value:function(){var t=J();return Object.assign(t.loggedIDs||{},t.anonymousIDs||{},t.sessionIDs||{})}},{key:"isReady",value:function(){return this.state===Y}},{key:"retry",value:function(){var t=this;this.state="statusScheduled",this.callbacks.onRetry.forEach((function(t){return t()})),setTimeout((function(){t.state=$,t.load()}),s.IDENTIFICATION_LOAD_RETRY_AFTER_MSECS)}},{key:"setLoggedUser",value:function(t,e){if(-1===Q.indexOf(t))throw Error(d.INVALID_AUTH_TOKEN);var n,o,r,i=J();i.loggedIDs=Object.assign(i.loggedIDs||{},(n={},r=e,(o=X(o=t))in n?Object.defineProperty(n,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[o]=r,n))}},{key:"setAnonymousUser",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=J();if(null==n.anonymousIDs||e){if(!("glb_uid"in t)||!("glb_uid_public"in t))throw d.mustBeDefined("glb_uid and glb_uid_public");var o={glb_uid:t.glb_uid,glb_uid_public:t.glb_uid_public};n.anonymousIDs=Object.assign(n.anonymousIDs||{},o)}}},{key:"getAnonymousUser",value:function(){return J().anonymousIDs}},{key:"getHsid",value:function(){return J().sessionIDs}},{key:"setSessionID",value:function(t){t.hsid&&(J().sessionIDs={hsid:t.hsid})}},{key:"removeLoggedUser",value:function(){var t=J();Q.forEach((function(e){t.loggedIDs[e]&&delete t.loggedIDs[e]}))}},{key:"load",value:function(){var t=this;if(this.state===$){this.state="statusLoading",this.callbacks.onLoad.forEach((function(t){return t()}));var e=s.USE_HTTPS?"https://":"http://";M("GET","".concat(e).concat(this.url),(function(e){t.setSessionID(e),t.setAnonymousUser(e,!1),t.state=Y,t.callbacks.onReady.forEach((function(e){return j(e,t.getClientIDs())}))}),(function(e){t.state=tt,t.callbacks.onError.forEach((function(t){return j(t,e)})),t.retry()}))}}}],n&&function(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,X(o.key),o)}}(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),nt=function(t){var e=J();if(!e.instance){var n=t||"".concat(s.HORIZON_TRACK_HOST,"/").concat(s.HORIZON_TRACK_IDENTIFICATION_RESOURCE),o=!1===s.AVOID_COOKIE_USAGE;e.instance=new et(n,o)}return e.instance};const ot={getInstance:nt,getContextManager:J,setLoggedUser:function(t,e){if(!s.AVOID_COOKIE_USAGE)throw Error(d.USE_MANAGER_ONLY_WHEN_AVOIDING_COOKIE);t&&0!==t.length||d.mustBeDefined("tokenName"),e&&0!==e.length||d.mustBeDefined("tokenValue"),nt().setLoggedUser(t,e)},removeLoggedUser:function(){if(!s.AVOID_COOKIE_USAGE)throw Error(d.USE_MANAGER_ONLY_WHEN_AVOIDING_COOKIE);nt().removeLoggedUser()},setAnonymousUser:function(t){nt().setAnonymousUser(t)},getAnonymousUser:function(){return nt().getAnonymousUser()},getHsid:function(){return nt().getHsid()}};function rt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function it(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rt(Object(n),!0).forEach((function(e){var o,r,i;o=t,r=e,i=n[e],(r=st(r))in o?Object.defineProperty(o,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[r]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function at(t){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},at(t)}function st(t){var e=function(t){if("object"!==at(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!==at(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===at(e)?e:String(e)}var ut="stateNotReady",ct="stateLoading",lt=["web","instant-article","app"];const ft=function(){function t(){var n=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"web";if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tenant=o||K("SITE_ID")||Z("ut.profile")||"unknown",this.deviceGroup=i||K("MOBILE_GROUP")||Z("platform")||"unknown",this.defaultContentType=a,-1===lt.indexOf(u))throw Error(d.INVALID_ENVIRONMENT);this.environment=u,this.validator=b,this.clientVersion=s.PACKAGE_VERSION,this.state=ut,this.referer=document.referrer;var c=null,l=null,f=null,h=function(){return r("horizonActionInfo",{horizonActionSequence:0,horizonClientContextID:e()()})};this.getHorizonActionSequence=function(){var t=h();return 2147483647===t.horizonActionSequence&&(t.horizonActionSequence=0),t.horizonActionSequence+=1,t.horizonActionSequence},this.getHorizonClientContextID=function(){return h().horizonClientContextID},this.getHorizonActionExtraAttributes=function(){return""},this.updateHorizonClientContextID=function(){h().horizonClientContextID=e()()},this.setSchemasProvider=function(t){c=t},this.getSchemasProvider=function(){if(!c){var t=((e=F()).provider||(e.provider=new B("".concat(s.HORIZON_SCHEMAS_HOST,"/schemas"))),e.provider);n.setSchemasProvider(t)}var e;return c},this.setEventBus=function(t){l=t},this.getEventBus=function(){if(!l){var t=function(t,e,n,o){var i=r("bus",{}),a="".concat(t,"-").concat(e);return i[a]||(i[a]=new V(t,s.HORIZON_CLIENT_UUID,e,n,o)),i[a]}(n.tenant,n.deviceGroup,n.environment,n.getIdManager());n.setEventBus(t)}return l},this.setIdManager=function(t){f=t},this.getIdManager=function(){if(!f){var t=ot.getInstance();n.setIdManager(t)}return f},this.isReady=function(){return!!c&&!!f&&n.validator.isReady()&&c.isReady()&&f.isReady()},window.addEventListener("beforeunload",(function(){n.unload()}))}var n,o;return n=t,o=[{key:"useDefaultContentType",value:function(t){this.defaultContentType=t}},{key:"setValidator",value:function(t){this.validator=t}},{key:"setReferer",value:function(t){this.referer=t||document.referrer}},{key:"unload",value:function(){this.flush()}},{key:"getScopeInfo",value:function(t){return{url:document.location.href,actionTs:+Date.now(),horizonClientVersion:this.clientVersion,horizonClientReferer:this.referer,horizonRelationId:t,horizonActionUUID:e()(),horizonActionSequence:this.getHorizonActionSequence(),horizonClientContextID:this.getHorizonClientContextID(),horizonActionExtraAttributes:this.getHorizonActionExtraAttributes()}}},{key:"validateBeforeEnqueue",value:function(t){var e=this.getSchemasProvider().get(t.id,t.version);this.validator.validateFor(t,e)}},{key:"onReady",value:function(t){this.validator.isReady()?this.getSchemasProvider().isReady()?this.getIdManager().isReady()?(this.state="stateReady",t()):(this.state=ct,this.getIdManager().onReady(t),this.getIdManager().load()):(this.state=ct,this.getSchemasProvider().onReady(t),this.getSchemasProvider().load()):(this.state=ct,this.validator.onReady(t),this.validator.load())}},{key:"flush",value:function(){var t=this;this.isReady()?this.getEventBus().flush():this.onReady((function(){return t.flush()}))}},{key:"send",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null!=n&&"string"!=typeof n)throw new Error("".concat(d.INVALID_RELATION_ID," Wrong relationId type. It should be a String: actual type is ").concat(at(n)));[].concat(t).forEach((function(t){e.validator.validateArgs(t),e.sendWithInfo(t,e.getScopeInfo(n))}))}},{key:"sendWithInfo",value:function(t,e){var n=this;if(!this.isReady())return this.state===ut&&this.flush(),void this.onReady((function(){return n.sendWithInfo(t,e)}));this.validateBeforeEnqueue(t);var o=it(it({},e),t);o.contentType||(this.defaultContentType||d.mustBeDefined("contentType"),o.contentType=this.defaultContentType),this.getEventBus().enqueue(o)}},{key:"newContextId",value:function(){this.updateHorizonClientContextID()}},{key:"getContextId",value:function(){return this.getHorizonClientContextID()}}],o&&function(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,st(o.key),o)}}(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),t}();var dt={setLoggedUser:ot.setLoggedUser,removeLoggedUser:ot.removeLoggedUser,setAnonymousUser:ot.setAnonymousUser,getAnonymousUser:ot.getAnonymousUser,getHsid:ot.getHsid}})(),o})(),t.exports=e()}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var i=e[o]={exports:{}};return t[o](i,i.exports,n),i.exports}(()=>{"use strict";var t,e=new Uint8Array(16);function o(){if(!t&&!(t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(e)}const r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var i=[],a=0;a<256;++a)i.push((a+256).toString(16).substr(1));const s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(i[t[e+0]]+i[t[e+1]]+i[t[e+2]]+i[t[e+3]]+"-"+i[t[e+4]]+i[t[e+5]]+"-"+i[t[e+6]]+i[t[e+7]]+"-"+i[t[e+8]]+i[t[e+9]]+"-"+i[t[e+10]]+i[t[e+11]]+i[t[e+12]]+i[t[e+13]]+i[t[e+14]]+i[t[e+15]]).toLowerCase();if(!function(t){return"string"==typeof t&&r.test(t)}(n))throw TypeError("Stringified UUID is invalid");return n},u=function(t,e,n){var r=(t=t||{}).random||(t.rng||o)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return s(r)},c=t=>window.cdaaas&&window.cdaaas.SETTINGS?window.cdaaas.SETTINGS[t]:null,l=t=>{if(!window.dataLayer)return null;let e=[...window.dataLayer].reverse().find((e=>Object.keys(e).includes(t)));return void 0!==e?e[t]:null},f=t=>window.utag_data?window.utag_data[t]||null:window.utag&&window.utag.data&&window.utag.data[t]||null,d=()=>f("tipo_pagina")||l("tipo_pagina")||"",h=()=>f("editoria_path")||l("editoria_path")||"",y=()=>f("dom.title")||l("dom.title")||"",p=()=>f("app_version")||l("app_version")||"",v=()=>{const t=c("CATEGORIAS");return null==t?"":t.join(",")},g=f,m=l;var E=n(348);location.hostname.indexOf("qa.globoi")>-1&&E.Settings.useQAConfiguration();let b=f("horizonTenant")||(()=>{const t=document.getElementById("horizon-common-hit-loader");if(t)return t.dataset.tenant})()||c("SITE_ID")||f("ut.profile")||"unknown";const I=new E.HorizonClient(b);I.sendWithContexts=function(t,e){if(!("contexts"in t))return I.send(t,e);if(!t.contexts||0==Object.keys(t.contexts).length)return delete t.contexts,I.send(t,e);const n=Object.assign(t.contexts);delete t.contexts;let o=[t];for(let t of n){const e={id:`context-${t.id}`,version:t.version,contentType:"context",properties:{eventId:"",...t.properties}};o.push(e)}I.send(o,e)};const S=I;let _,w=g("editoria")||m("editoria")||null;Array.isArray(w)&&(w=w.join(","));try{const t=[{id:"publishing-platform",version:"0.1",properties:{pageWithVideo:g("has_video")||m("has_video")||null,affiliates:g("ga_nome_afiliadas")||m("ga_nome_afiliadas")||null,updateDate:g("data_atualizacao")||m("data_atualizacao")||null,publishDay:g("dia_publicacao")||m("dia_publicacao")||null,editoria:w,pageType:g("page_name")||m("page_name")||null,pictureOnTop:g("has_top_image")||m("has_top_image")||null,editorialPath:g("editoria_path")||m("editoria_path")||null,wordsQuantityRange:window.word_count_range||null,feedType:g("feed_type")||m("feed_type")||null,contentType:g("content_type")||m("content_type")||null,pageWithPicture:g("has_photo")||m("has_photo")||null,pageWithGif:g("has_gif")||m("has_gif")||null,pageWithTable:g("has_table")||m("has_table")||null,pageWithGraph:g("has_chart")||m("has_chart")||null,pageWithEntendaOCaso:g("has_entenda")||m("has_entenda")||null,pageWithSummary:g("has_resumo")||m("has_resumo")||null,pageWithReadMore:g("has_related")||m("has_related")||null,pageWithVotes:g("has_votacao")||m("has_votacao")||null,pollId:g("resource_id")||m("resource_id")||null}}];_=()=>{const e=u();window.commonSignals.commonHitRelationId=e,S.sendWithContexts({id:"common-hit",version:"0.1",contentType:"common",properties:{tags:v(),contentCategory:h(),contentType:d()},contexts:t},e),S.sendWithContexts({id:"common-hit",version:"1.1",contentType:"common",properties:{tags:v(),applicationVersion:p(),title:y(),contentCategory:h(),contentType:d()}},e)}}catch(t){_=()=>{S.send({id:"common-hit",version:"0.1",contentType:"common",properties:{tags:v(),contentCategory:h(),contentType:d()}}),S.send({id:"common-hit",version:"1.1",contentType:"common",properties:{tags:v(),applicationVersion:p(),title:y(),contentCategory:h(),contentType:d()}})},S.send({id:"common-event",version:"0.1",contentType:"common",properties:{eventCategory:"context-tracker",eventAction:"error",eventLabel:t.toString()}})}const O=_;let T=document.location.href;function A(t){return function(){t.send(T),window.requestAnimationFrame((()=>{O()})),T=document.location.href}}function R(t,e){return S.sendWithContexts({id:"common-event",version:"0.1",contentType:"common",properties:t,contexts:e})}const C=function(t={enableGA:!1}){const e=t.enableGA;var n=t.trackingIds?t.trackingIds:[];if(o().length<1&&n.length>0)throw"No tracker valid for selected trackingIds";function o(){var t=[],e=[],o=function(){if("ga"in window&&"getAll"in window.ga)return window.ga.getAll()}();for(var r in o){var i=o[r],a=i.get("trackingId");if(!t.includes(a)){if(n.length>0&&!n.includes(a))continue;e.push(i),t.push(a)}}return e}function r(t,e,n,r){var i=o();for(var a in i)i[a].send("event",t,e,n,r)}return{sendEvent:function(t,n,o,i){e&&r(t,n,o,i),((t,e,n,o)=>{let r={eventCategory:t,eventAction:e,eventLabel:n,eventValue:o,eventProperty:"using-common-tracker"};Object.keys(r).forEach((t=>void 0===r[t]?delete r[t]:{})),R(r)})(t,n,o,i)},sendEventWithContexts:function(t,n){e&&r(t.eventCategory,t.eventAction,t.eventLabel,t.eventValue),R(t,n)}}},N={updateHorizonClientContextID:S.updateHorizonClientContextID,getHorizonClientContextID:S.getHorizonClientContextID};window.commonSignals=window.commonSignals||{enabled:!0},O();const D=((t=null,e=null,n=I)=>{null===e&&(e=document),(t=t||(()=>{let t,e=!1,n=0,o=t;return{start:()=>{t=performance.now()},startCountingVisibility:()=>{e||(o=performance.now(),e=!0)},stopCountingVisibility:()=>{if(e){const t=performance.now();n+=t-o,o=t,e=!1}},getTotalTime:(t=!1)=>{const r=performance.now();let i;return e&&(n+=r-o,o=r),i=n,n=t?0:n,i}}})()).start(),"visible"===e.visibilityState&&t.startCountingVisibility();const o=((t=null)=>{let e=null,n=null,o=[5,20,40,60];const r=function(){e=1e3*o[0],1!==o.length&&o.shift()};r();const i=function(){n=setTimeout((()=>{t(),r(),i()}),e)};return{setSend:e=>{t=e},getCurrentInterval:()=>e,start:()=>{try{if("function"!=typeof t)throw new Error("Send is not a function or has not been defined.");i()}catch(t){console.log(t)}},stop:()=>{clearTimeout(n)}}})(),r=(e=document.location.href)=>{const r=t.getTotalTime(!0),i=Math.round(Math.max(0,Math.min(r,1.02*o.getCurrentInterval()))),a=window.commonSignals.commonHitRelationId;n.send({id:"common-screentime",version:"1.0",contentType:"common",url:e,properties:{visibilityTimeMs:i}},a)};return o.setSend(r),o.start(),document.addEventListener("visibilitychange",(()=>{if("hidden"!==e.visibilityState&&"visible"!==e.visibilityState)return null;o.stop(),"hidden"===e.visibilityState?(t.stopCountingVisibility(),r()):(t.startCountingVisibility(),o.start())})),window.addEventListener("beforeunload",(()=>{r()})),{send:r}})();(location.hostname.includes("globoplay.globo")||location.hostname.includes("cartolafc.globo.com"))&&function(t){const e=A(t);window.addEventListener("popstate",(()=>{e()})),window.addEventListener("pushState",(()=>{e()})),window.addEventListener("replaceState",(()=>{e()}));var n=function(t){var e=window.history[t];return function(){var n=e.apply(this,arguments),o=new Event(t);return o.arguments=arguments,window.dispatchEvent(o),n}};window.history.pushState=n("pushState"),window.history.replaceState=n("replaceState")}(D);const k=A(D);window.commonSignals.commonTracker=C,window.commonSignals.triggerPageChange=k,window.commonSignals.sendScreentimeEvent=D.send,window.commonTracker=C,window.sendCommonHit=O,window.commonSignals.updateClientContextId=N.updateHorizonClientContextID,window.commonSignals.getClientContextId=N.getHorizonClientContextID;const L=new Event("commonSignalsReady");window.dispatchEvent(L)})()})();